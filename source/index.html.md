---
title: OmniBOLT API Reference

language_tabs: # must be one of https://git.io/vQNgJ
  - shell
  - javascript
  - golang

toc_footers:
  - <a href='https://github.com/LightningOnOmnilayer/LightningOnOmni'>Join our dev community</a>
  - <a href='https://github.com/LightningOnOmnilayer/Omni-BOLT-spec'>Help in OmniBOLT specification</a>
  - <a href='https://github.com/lord/slate'>Documentation Powered by Slate</a>

 
includes:
  - fund_channel
  - deposit_tokens
  - payments_in_channel
  - htlc
  - query
  
search: true
---

# OmniBOLT Daemon Websocket Messages Reference

Welcome to the Websocket API reference documentation for OmniBOLT Daemon (OBD), the daemon that communicates with light clients written in any program languages that support websocket connection, such as javascript, golang, shell or even C/C++. OBD runs as an independent process connecting to a full node of OmniCore(version 0.18), which provides the complete services of token transactions on bitcoin network. And current OBD implementation is deeply binded to OmniCore. 

We assume you have already gone through our [installation instruction](https://github.com/LightningOnOmnilayer/LightningOnOmni#installation), so that you are familar with:

 * Pulling source code and compile to get obdserver;  
 * Configuring OmniCore node for OBD;  
 * Connecting OBD with Omnicore correctly;  
 * Using a simple web based [websocket client](https://chrome.google.com/webstore/detail/websocket-test-client/fgponpodhbmadfljofbimhhlengambbn?hl=en) for Chrome to do experiments;  
 * OBD responses you correctly;  

For kernel developers in our community, the above steps are the easiest way to get started. Just open [LightningOnOmni](https://github.com/LightningOnOmnilayer/LightningOnOmni#step-4-test-channel-operations-using-websocket-testing-tool) project with your favorit golang editor, run OBD in debug mode, setup break points, and send messages from your websocket-test-client. You may intercept the messages and track message flows of OBD kernel.


# SignUp

## Simple Type 101 Protocol

Type 101 Protocol is used to sign up a new user by hirarchecal deterministic wallet system.
It returns mnemonic words as a UserID.

<!-- Comment by Kevin 2019-11-29
This endpoint manages users created by an OBD instance. Here we use Alice and Bob for testing purpose. The complete hirarchecal deterministic wallet system will be integrated soon, functions being including but not limited to: generat user mnemonic words, public/private key paires, PIN code, restore account. -->

## Websocket Request: Message Type 101

<!-- right -->
> Sign up request:

```json
{
	"type":101
}
```

<!-- center -->
This request has no parameters.

## Websocket Response: Message Type 101

<!-- right -->
> OBD Responses:

```json
{
    "type":101,
    "status":true,
    "from":"c2215a60-8b81-439f-8cb3-11ba51691076",
    "to":"c2215a60-8b81-439f-8cb3-11ba51691076",
    "result":"two ribbon knee leaf easy pottery hobby pony mule test bridge liar sand mirror decline gasp focus this park undo rough cricket portion ignore"
}
```

<!-- center -->
Parameter | default | placement | Description
--------- | ------- | --------- | ------------
status    | ------- |   body    | true or false
from      | ------- |   body    | socket id generated when establishing a websocket connection
to        | ------- |   body    | socket id generated when establishing a websocket connection
result    | ------- |   body    | response data from OBD


# LogIn

## Simple Type 1 Protocol

Type 1 Protocol is used to login to OBD.

## Websocket Request: Message Type 1

> Login request:

```json
{
    "type":1,
    "data":{
        "mnemonic":"< mnemonic words generated by OBD >"
    }
}
```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
mnemonic  | ------- |   data    | mnemonic words generated by OBD

## Websocket Response: Message Type 1

> OBD Responses:

```json
{
    "type":1,
    "status":true,
    "from":"7da8d2441e0ad67040a274902f1965ee1a5c3fdd86f1ddc3280eda5230e006f2",
    "to":"all",
    "result":"7da8d2441e0ad67040a274902f1965ee1a5c3fdd86f1ddc3280eda5230e006f2 login"
}
```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
status    | ------- |   body    | true or false
from      | ------- |   body    | A SHA256 string of mnemonic words as the peer id
to        | ------- |   body    | to whom should know the login of this peer
result    | ------- |   body    | response data from OBD

<aside class="warning">This is not ready for production environment, only for test. The complete set of wallet functions are on our schedule.</aside>

 
<!-- # create channel -->

# OpenChannel

## Simple Type -32 Protocol

Type -32 Protocol is used to request to create a channel with someone. 

Alice sends request to her OBD instance, her OBD helps her complete the message, and routes her request to Bob's OBD for creating a channel between them. 

## Websocket Request: Message Type -32

> Request:

```json
{
	"type":-32,
	"data":{
		"funding_pubkey":"021d475729c52f86df24b36aa231945bd090f9c23ccbfb91e4ade6813b2419d32d"
	},
	"recipient_peer_id":"<user_id>"
}
```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
funding pubkey    | ------- |   data    | public key of funder, who wish to deposite BTC and other tokens to the channel
recipient_peer_id | ------- |   body    | peer id of the fundee.
 
## Websocket Response: Message Type -32

> OBD Response:

```json
{
	"type":-32,
	"status":true,
	"from":"<user_id>",
	"to":"<user_id>",
	"result":
	{
		"chain_hash":"1EXoDusjGwvnjZUyKkxZ4UHEf77z6A5S4P",
		"channel_reserve_satoshis":0,
		"delayed_payment_base_point":"",
		"dust_limit_satoshis":0,
		"fee_rate_per_kw":0,
		"funding_address":"mx4TDCXP2DedxcuA8RXaQ6c4q2GKAimUPs",
		"funding_pubkey":"021d475729c52f86df24b36aa231945bd090f9c23ccbfb91e4ade6813b2419d32d",
		"funding_satoshis":0,
		"htlc_base_point":"",
		"htlc_minimum_msat":0,
		"max_accepted_htlcs":0,
		"max_htlc_value_in_flight_msat":0,
		"payment_base_point":"",
		"push_msat":0,
		"revocation_base_point":"",
		"temporary_channel_id":[43,207,125,166,133,84,214,91,184,177,149,10,111,209,133,201,147,178,48,245,6,18,162,239,207,45,105,158,251,200,138,183],
		"to_self_delay":0
	}
}
```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
status    | ------- |    body   | true or false
from      | ------- |    body   | peer id of funder
to        | ------- |    body   | peer id of fundee
chain_hash | ------- |  result | identify the public chain. Default is OmniLayer's address: 1EXoDusjGwvnjZUyKkxZ4UHEf77z6A5S4P
channel_reserve_satoshis   | ------- |    result   | reserved satoshis in the channel
delayed_payment_base_point | ------- |    result   | 
dust_limit_satoshis        | ------- |    result   | 
fee_rate_per_kw            | ------- |    result   | 
funding_address            | ------- |    result   | Funder's address from where he send money to the channel
funding_pubkey             | ------- |    result   | public key of funder, who wish to deposite BTC and other tokens to the channel 
funding_satoshis           | ------- |    result   | 
htlc_base_point            | ------- |    result   | 
htlc_minimum_msat          | ------- |    result   | 
max_accepted_htlcs         | ------- |    result   | 
max_htlc_value_in_flight_msat      | ------- |    result   | 
payment_base_point                 | ------- |    result   | 
push_msat                          | ------- |    result   | 
revocation_base_point              | ------- |    result   | 
temporary_channel_id               | ------- |    result   | 
to_self_delay                      | ------- |    result   | 


# AcceptChannel

## Simple Type -33 Protocol

Type -33 Protocol is used to response to request of creating channel.

Bob replies to accept, his OBD completes his message and routes it to Alice's OBD.
Then Alice sees the response of acceptance. 

## Websocket Request: Message Type -33

> Request:

```json
{
	"type":-33,
	"data":{
		"temporary_channel_id":[43,207,125,166,133,84,214,91,184,177,149,10,111,209,133,201,147,178,48,245,6,18,162,239,207,45,105,158,251,200,138,183],
		"funding_pubkey":"03efd8923f1829ece87202892d31cd75c20b7a7b5adf888f7ba04fa2c1bc931ce9",
		"approval":true
	}
}
```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
temporary_channel_id  | ------- |   data    | the temporary channel id, used before real funding completes.
funding pubkey        | ------- |   data    | public key of fundee(Bob), who wish to deposite BTC and other tokens to the channel. Current implementation of OBD supports one-way deposite. Fundee does not need to fund the channel.
approval              | ------- |   data    | true or false to deny.
 
## Websocket Response: Message Type -33

> OBD Responses:

```json
{
	"type":-33,
	"status":true,
	"from":"<user_id>",
	"to":"<user_id>",
	"result":
	{
		"accept_at":"2019-09-21T00:06:48.634265+08:00",
		"address_a":"mx4TDCXP2DedxcuA8RXaQ6c4q2GKAimUPs",
		"address_b":"myHRPQWTQ1yYbj7vr7raBW59CTeAFEsUXY",
		"chain_hash":"1EXoDusjGwvnjZUyKkxZ4UHEf77z6A5S4P",
		"channel_address":"2N1DFjaE4yCcECdFwgLQcLmNrLV5zetgQtE",
		"channel_address_redeem_script":"5221021d475729c52f86df24b36aa231945bd090f9c23ccbfb91e4ade6813b2419d32d2103efd8923f1829ece87202892d31cd75c20b7a7b5adf888f7ba04fa2c1bc931ce952ae",
		"channel_address_script_pub_key":"a9145761a1d45b8a6e7caa10a4bcecca97630c67af4687",
		"channel_id":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		"channel_reserve_satoshis":0,
		"close_at":"0001-01-01T00:00:00Z",
		"create_at":"2019-09-21T00:05:25.667117+08:00",
		"create_by":"alice",
		"curr_state":20,
		"delayed_payment_base_point":"",
		"dust_limit_satoshis":0,
		"fee_rate_per_kw":0,
		"funding_address":"mx4TDCXP2DedxcuA8RXaQ6c4q2GKAimUPs",
		"funding_pubkey":"021d475729c52f86df24b36aa231945bd090f9c23ccbfb91e4ade6813b2419d32d",
		"funding_satoshis":0,
		"htlc_base_point":"",
		"htlc_minimum_msat":0,
		"id":2,
		"max_accepted_htlcs":0,
		"max_htlc_value_in_flight_msat":0,
		"payment_base_point":"",
		"peer_id_a":"alice",
		"peer_id_b":"bob",
		"pub_key_a":"021d475729c52f86df24b36aa231945bd090f9c23ccbfb91e4ade6813b2419d32d",
		"pub_key_b":"03efd8923f1829ece87202892d31cd75c20b7a7b5adf888f7ba04fa2c1bc931ce9",
		"push_msat":0,
		"revocation_base_point":"",
		"temporary_channel_id":[43,207,125,166,133,84,214,91,184,177,149,10,111,209,133,201,147,178,48,245,6,18,162,239,207,45,105,158,251,200,138,183],
		"to_self_delay":0
	}
}
```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
status    | ------- |    body   | true or false
from      | ------- |    body   | peer id of funder
to        | ------- |    body   | peer id of fundee
accept_at | ------- |    result   | time of acceptance
address_a | ------- |    result   | address of Alice
address_b | ------- |    result   | address of Bob
chain_hash | ------- |   result   | identify the public chain. Default is OmniLayer's address: 1EXoDusjGwvnjZUyKkxZ4UHEf77z6A5S4P
channel_address                | ------- |    result   | the p2whk address of the channel
channel_address_redeem_script  | ------- |    result   | redeem script of the multi-sig address
channel_address_script_pub_key | ------- |    result   | the script pubkey
channel_id                     | ------- |    result   | the global unique channel id
channel_reserve_satoshis       | ------- |    result   | reserved satoshis in the channel
close_at                       | ------- |    result   | close time
create_at                      | ------- |    result   | create time
create_by                      | ------- |    result   | the funder who created this channel. Alice in this case.
curr_state                     | ------- |    result   | 
delayed_payment_base_point | ------- |    result   | 
dust_limit_satoshis        | ------- |    result   | 
fee_rate_per_kw            | ------- |    result   | 
funding_address            | ------- |    result   | Funder's address from where he send money to the channel
funding_pubkey             | ------- |    result   | public key of funder, who wish to deposite BTC and other tokens to the channel 
funding_satoshis           | ------- |    result   | 
htlc_base_point            | ------- |    result   | 
htlc_minimum_msat          | ------- |    result   | 
max_accepted_htlcs         | ------- |    result   | 
max_htlc_value_in_flight_msat      | ------- |    result   | 
payment_base_point                 | ------- |    result   | 
peer_id_a                          | ------- |    result   | peer id of funder
peer_id_b                          | ------- |    result   | peer id of fundee
pub_key_a                          | ------- |    result   | public key of funder
pub_key_b                          | ------- |    result   | public key of fundee. Current OBD implementation does not requir fundee to deposit money to a channel.
push_msat                          | ------- |    result   | 
revocation_base_point              | ------- |    result   | 
temporary_channel_id               | ------- |    result   | 
to_self_delay                      | ------- |    result   | 

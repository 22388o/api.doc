## commitmentTransactionCreated

### Simple Type -100351 Protocol

<!-- center -->

Type -100351 Protocol is used for paying omni assets by Revocable Sequence Maturity Contract(RSMC) within a channel.


<aside class="notice">
After creating a channel and funding the channel by BTC and assets, <code>Alice</code>/<code>Bob</code> then is able to use this channel to pay to each other. OBD constructs commitment transaction for each payment between the two counterparts. The i-th commitment transaction will be invalidated after creating the (i+1)-th commitment transaction.
</aside>

Here(in the right) are the example data generated by OBD used in contructing temporary multi-sig addresses and temporary transactions for i-th commitment transaction. You shall find your corresponding temporary data within the responses of your OBD.

<!-- right -->
> example data:

```shell
last_temp_address： 
{
        "address":"mkPtXTRyA53ddhknMnVqNCDdeN2FsXmtwe",
        "index":12,
        "pub_key":"02fed65567b2ab00e2cbb28b46a687ce8fd0894486989cba54975b45bbc6a85ed8",
        "wif":"cTiDwaM3y5LE2HuWWgvRTC9mgHiovf2zntjSgCPyLLeuUTmKk1BY"
}

curr_temp_address： 
{
        "address":"mhAMwJW2bMtJ5iW4dp1EUT8nGi9LF1PXgj",
        "index":6,
        "pub_key":"03985e8880628058da7c49b0968e4e7d2819240b60255a1c9b5f2407a4056b5f54",
        "wif":"cTLc9tx1Hihqfu6jXXWQ8pFeiQb5aJ8ck88ik8RJuutP95dqTuqo"
}
```

### Websocket Request: Message Type -100351

<!-- right -->
> Request:

```json 
{
	"type":-100351,
	"recipient_node_peer_id":"QmVEoTmyofsbEnsoFwQXHngafECHJuVfEgGyb2bZtyiont",
	"recipient_user_peer_id":"39e8b1f3e7aec51a368d70eac6d47195099e55c6963d38bcd729b22190dcdae0",
	"data":{
		"channel_id":"ea5096b1864bcfa398486ca659dfb5711506d851fc4626075ecd388a65b6cde9",
		"amount":3,
		"curr_temp_address_pub_key":"03985e8880628058da7c49b0968e4e7d2819240b60255a1c9b5f2407a4056b5f54",
		"curr_temp_address_private_key":"cTLc9tx1Hihqfu6jXXWQ8pFeiQb5aJ8ck88ik8RJuutP95dqTuqo",
		"channel_address_private_key":"cVV22tLgBbLv1K1uW6z2doR4Copat1mejjND1jtW8CVkRLUSpPxf",
		"last_temp_address_private_key":"cTiDwaM3y5LE2HuWWgvRTC9mgHiovf2zntjSgCPyLLeuUTmKk1BY"
    }
}

```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
channel_id         	| ------- |   data    | 
amount  			| ------- |   data    | amount to pay.
curr_temp_address_pub_key       | ------- |   data    | temporary multi-sig address.
curr_temp_address_private_key   | ------- |   data    | the private key of the temporary multi-sig address currently in use.
channel_address_private_key     | ------- |   data    | Alice's private key of the channel.
last_temp_address_private_key   | ------- |   data    | the private key of the previous temporary multi-sig address.


### Websocket Response: Message Type -100351

> OBD Responses:

```json 
{
	"type":-110351,
	"status":true,
	"from":"1f1dbb3518c1fb12f263d065c1d18576d13f88dff55bfc25ef52afaa2c97a5d2@/ip4/127.0.0.1/tcp/4001/p2p/QmVEoTmyofsbEnsoFwQXHngafECHJuVfEgGyb2bZtyiont",
	"to":"1f1dbb3518c1fb12f263d065c1d18576d13f88dff55bfc25ef52afaa2c97a5d2",
	"result":{
		"amount":3,
		"channel_id":"ea5096b1864bcfa398486ca659dfb5711506d851fc4626075ecd388a65b6cde9",
		"commitment_tx_hash":"c9ddb048fd69db8f9df0ba37a72d1d6979da2edc8bb258dbafcf263937d8b0c6",
		"curr_temp_address_pub_key":"03985e8880628058da7c49b0968e4e7d2819240b60255a1c9b5f2407a4056b5f54",
		"last_temp_address_private_key":"cTLc9tx1Hihqfu6jXXWQ8pFeiQb5aJ8ck88ik8RJuutP95dqTuqo",  			"rsmc_hex":"0200000001c3328e96db5081329455b362d5e96237c760d1e65b67d8abadedf53949e1e2a900000000920047304402200f031ad0f55b2303179a1a48270149f76784cdd20926180085b69c64e0e46eff02207c3ab2bb56a9f9863c33f609d84b51b03e7b592e28dec63f06f65f7b853cc9ae010047522102c57b02d24356e1d31d34d2e3a09f7d68a4bdec6c0556595bb6391ce5d6d4fc6621028f49447e1a20d4211c8c621976cff3d2ae00d4af79be3e74e05f1ed4e23f319e52aeffffffff03344700000000000017a9146816548153dd030f92540b24e9605c0c565cc378870000000000000000166a146f6d6e690000000000000089000000006553f1001c0200000000000017a9146816548153dd030f92540b24e9605c0c565cc3788700000000",  		"to_counterparty_tx_hex":"0200000003e062124a8f5476cd4cff020894525d360f6d0ab4a8d2b357a90f328c3dabe2d900000000920047304402201e687dae90d407e4200081052826c4586af4c11360bc208315a5fba9e8d731f802207b31fce12e77806bf3b5681297e94ae4aa04f8628ed00aea89c6152f043e7c69010047522102c57b02d24356e1d31d34d2e3a09f7d68a4bdec6c0556595bb6391ce5d6d4fc6621028f49447e1a20d4211c8c621976cff3d2ae00d4af79be3e74e05f1ed4e23f319e52aeffffffffea5096b1864bcfa398486ca659dfb5711506d851fc4626075ecd388a65b6cdeb0200000092004730440220656924074ebf39dfb94915f23ffa6dae36cf1c59954af5d29c7e749c8cdc847a022057049291636cfcaa8d97a80e1af7687e9e1d2809162908783f22813a1260859f010047522102c57b02d24356e1d31d34d2e3a09f7d68a4bdec6c0556595bb6391ce5d6d4fc6621028f49447e1a20d4211c8c621976cff3d2ae00d4af79be3e74e05f1ed4e23f319e52aefffffffffcabe9c10966c7640e41fcbc1e597991d4da4edc2f6e257c6159c1d7c34a8b820000000092004730440220057a058dcab077217aaedd778a524a69757de4cb37a0954f2d6ae3a3b75ee98f02203c3e0aa61550a5da0ae1641c236de5005ea1e0c48167723a6add2f11d389144e010047522102c57b02d24356e1d31d34d2e3a09f7d68a4bdec6c0556595bb6391ce5d6d4fc6621028f49447e1a20d4211c8c621976cff3d2ae00d4af79be3e74e05f1ed4e23f319e52aeffffffff03ea930000000000001976a9147a019f584f6a65d114d5f17264c9eb32f763d72c88ac0000000000000000166a146f6d6e6900000000000000890000000011e1a30022020000000000001976a914ceb05f96f5b3cbd12d7bff5f9f45252b3f67bf7088ac00000000"
    	}
}  
```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
status         | ------- |   body    | true or false
from	       | ------- |   body    | peer id of funder
to             | ------- |   body    | peer id of fundee
amount 	       | ------- |   result  |  
channel_id 				| ------- |   result    | 
commitment_tx_hash 			| ------- |   result    | commitment transaction hahs.
curr_temp_address_pub_key 		| ------- |   result    |  
last_temp_address_private_key 		| ------- |   result    | the private key of the previous temporary multi-sig address.
rsmc_hex 				| ------- |   result    | to RSMC(the multi-sig temp address) transaction hex.
to_counterparty_tx_hex 			| ------- |   result    | to counterparty(the address of counterparty) transaction hex.


## Revoke and Acknowledge Commitment Transaction(Debug mode only)

### Simple Type -100352 Protocol

Receiver revokes the previous commitment transaction and ackonwledge the new transaction.

<aside class="warn">
This message is only for debug mode, because the light client don't need to manuely revoke and acknowledge a commitment. Plus he is not able to reject a RSMC payment, because payer hands over his private key of the previous transaction to payee.
</aside>


<!-- right -->
> example data:

```shell
last_temp_pub_key：
address  n2wKQgrfM5fFXmmA6xNWjWPPFPktJHnqEj
privkey cU78aif2a4YR5xK8HxBTrPKjdjhD8W4SSZNTw4yFEdwi59JMrYQY
pubkey 0298bdca47bbb76b1022eb7d18534961a12ce6dd80308c839576602b771e324fba 
curr_temp_address： 
{
        "address":"mo9sVgTYnrx1rdxxj3XYswAcUwnQKmGKoN",
        "index":7,
        "pub_key":"03b2e7ecc5ff62feb342943a1364f555e8302f507f78c6392c82b9e12c95ccb40b",
        "wif":"cPnHVbg3ZZoXhvgu5pWSx18zf9Dw5jfp7wMaDEx4JzHd9zqh1etk"
}
```

### Websocket Request: Message Type -100352

> Request:

```json
{
	"type":-100352,
	"recipient_node_peer_id":"QmVEoTmyofsbEnsoFwQXHngafECHJuVfEgGyb2bZtyiont",
	"recipient_user_peer_id":"1f1dbb3518c1fb12f263d065c1d18576d13f88dff55bfc25ef52afaa2c97a5d2",
	"data":{
        	"channel_id":"ea5096b1864bcfa398486ca659dfb5711506d851fc4626075ecd388a65b6cde9",
        	"curr_temp_address_pub_key":"03b2e7ecc5ff62feb342943a1364f555e8302f507f78c6392c82b9e12c95ccb40b",
        	"curr_temp_address_private_key":"cPnHVbg3ZZoXhvgu5pWSx18zf9Dw5jfp7wMaDEx4JzHd9zqh1etk",
        	"last_temp_address_private_key":"cU78aif2a4YR5xK8HxBTrPKjdjhD8W4SSZNTw4yFEdwi59JMrYQY",
        	"msg_hash":"853a6adee774f65daf2bb4b59ffb3500293cd79e55c22d414438111320824a4f",
        	"channel_address_private_key":"cTWBhAwXyDtM5XxBwibUxMzH5R2na7WHCTXcnL2xq3y25S4mpAMd",
        	"approval":true
    	}
}

```

Parameter | default | placement | Description
--------- | ------- | --------- | ------------
channel_id         			| ------- |   data    | 
curr_temp_address_pub_key               | ------- |   data    | current multi-sig temp address pubkey.
curr_temp_address_private_key           | ------- |   data    | current multi-sig temp address private key.
last_temp_address_private_key		| ------- |   data    | previous multi-sig temp address private key. 
channel_address_private_key 		| ------- |   data    | private key of the channel that payee holds.
approval  | ------- |   data    | true or false


 
